function TemplateSource(){Base.apply(this,arguments);}TemplateSource.Inherit(Base,"TemplateSource");TemplateSource.Implement(ITemplateSource);TemplateSource.Implement(IItemTemplateSource);TemplateSource.Implement(IFreezable);TemplateSource.Implement(IFreezableHelper);TemplateSource.ImplementProperty("containerelement",new InitializeStringParameter("Optional. If specified points to a data-key in the sourcetemplate whos children form the set of templates. If specified whenever a sourcetemplate is set, it is retained as wrapping and the set of templates is acquired from the specified element.",null));TemplateSource.prototype.keysetchangedevent=new InitializeEvent("Fired every time any key set changes.");TemplateSource.prototype.templatesourcechangedevent=new InitializeEvent("Fired when the source templates changes");TemplateSource.prototype.wrappingchangedevent=new InitializeEvent("Fired whenever the wrapping changes");TemplateSource.prototype.$init=function(){var internals=$(this.root).children().clone();if(this.get_sourcetemplates()==null){this.$frozeEventsBlock(function(){this.set_sourcetemplates(internals);});}Base.prototype.init.call(this);};TemplateSource.prototype.$mainkeyset=null;TemplateSource.prototype.$keysets=new InitializeObject("Additional keysets");TemplateSource.prototype.get_keyset=function(idx){if(idx==null){return this.$mainkeyset;}else if(typeof idx=="string"){return this.$keysets[idx];}return null;};TemplateSource.prototype.set_keyset=function(idx,v){this.$itemtemplates_cached=null;this.$template_cached=null;if(arguments.length>1&&idx!=null){if(BaseObject.is(v,"Array")){this.$keysets[""+idx]=v;this.keysetchangedevent.invoke(this,""+idx);}else if(typeof v=="string"){this.$keysets[""+idx]=[v];this.keysetchangedevent.invoke(this,""+idx);}else if(v==null){this.$keysets[""+idx]=null;this.keysetchangedevent.invoke(this,""+idx);}else{throw"Unsupported keyset value (must be array, string or null)";}}else{if(BaseObject.is(idx,"Array")){this.$mainkeyset=idx;this.keysetchangedevent.invoke(this,null);}else if(typeof idx=="string"){this.$mainkeyset=[idx];this.keysetchangedevent.invoke(this,null);}else if(idx==null){this.$mainkeyset=idx;this.keysetchangedevent.invoke(this,null);}else{throw"Unsupported keyset value (must be array, string or null)";}}};TemplateSource.prototype.$sourcetemplates=null;TemplateSource.prototype.get_sourcetemplates=function(){return this.$sourcetemplates;};TemplateSource.prototype.set_sourcetemplates=function(v){this.$itemtemplates_cached=null;this.$template_cached=null;this.$sourcetemplates=v;this.templatesourcechangedevent.invoke(this,null);};TemplateSource.prototype.$get_sourcetemplates=function(){if(this.$sourcetemplates!=null){var cekey=this.get_containerelement();if(cekey!=null&&cekey.length>0){var container=this.$sourcetemplates.filter('[data-key="'+cekey+'"]');if(container.length==0)container=this.$sourcetemplates.find('[data-key="'+cekey+'"]');return container.children().clone();}else{return this.$sourcetemplates.clone();}}else{return null;}};TemplateSource.prototype.$wrapResult=function(jqset){var cekey=this.get_containerelement();if(this.$sourcetemplates!=null&&cekey!=null&&cekey.length>0){var srcclone=this.$sourcetemplates.clone();var container=srcclone.filter('[data-key="'+cekey+'"]');if(container.length==0)container=srcclone.find('[data-key="'+cekey+'"]');container.Empty();container.append(jqset);return srcclone;}else{return jqset;}};TemplateSource.prototype.constructTemplate=function(keys){var k=null;if(BaseObject.is(keys,"Array")){k=keys;}else if(typeof keys=="string"){k=[keys];}var result=$();if(k!=null){var $sourcetemplates=this.$get_sourcetemplates();if($sourcetemplates!=null){for(var i=0;i<k.length;i++){var some=$sourcetemplates.filter('[data-key="'+k[i]+'"]');if(some.length>0){for(var j=0;j<some.length;j++){result.push(some[j]);}}}}}return this.$wrapResult(result);};TemplateSource.prototype.$template_cached=null;TemplateSource.prototype.get_template=function(){if(this.$template_cached==null){this.$template_cached=this.constructTemplate(this.$mainkeyset);}return this.$template_cached.clone();};TemplateSource.prototype.set_template=function(){};TemplateSource.prototype.$itemtemplates_cached=null;TemplateSource.prototype.get_itemTemplate=function(idx){if(idx==null)return this.get_template();if(this.$itemtemplates_cached==null)this.$itemtemplates_cached={};if(this.$keysets!=null&&this.$keysets[idx]!=null){if(this.$itemtemplates_cached[idx]==null){this.$itemtemplates_cached[idx]=this.constructTemplate(this.$keysets[idx]);}return this.$itemtemplates_cached[idx].clone();}return null;};TemplateSource.prototype.set_itemTemplate=function(idx,v){};