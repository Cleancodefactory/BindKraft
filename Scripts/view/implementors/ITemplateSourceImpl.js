function ITemplateSourceImpl(){}ITemplateSourceImpl.InterfaceImpl(ITemplateSource,"ITemplateSourceImpl");ITemplateSourceImpl.RequiredTypes("Base");ITemplateSourceImpl.ForbiddenTypes("BaseWindow");ITemplateSourceImpl.classInitialize=function(cls,defaultTemplateSelector,options){cls.ImplementProperty("templateName",new InitializeStringParameter("module/templatename",defaultTemplateSelector),"templateName");ICustomParameterizationStdImpl.addParameters(cls,"templateName");cls.prototype.get_template=function(){var tml=this.$template;if(tml!=null)return tml;tml=ITemplateConsumer.ConsumeTemplate(this);if(tml!=null)return tml;tml=IItemTemplateConsumer.ConsumeTemplate(this,this.get_templateName());if(tml!=null)return tml;if(BaseObject.getProperty(options,"legacy",false)){tml=DOMUtil.queryOne(tmlName);if(tml!=null)return tml.innerHTML;tml=null;}var tn=ITemplateSourceImpl.ParseTemplateName(this.get_templateName());tml=ITemplateSourceImpl.GetGlobalTemplate(tn,options);if(tml!=null)return tml;return null;};cls.prototype.set_template=function(v){this.$template=v;};}.Description("").Param("defaultTemplateSelector","").Param("options","A plain object containing various options: legacy - search globaly with the name as selector; nodom - search registers only");ITemplateSourceImpl.GetGlobalTemplate=function(tn,options){var tml;if(typeof tn=="string")tn=ITemplateSourceImpl.ParseTemplateName(tn);if(tn.name!=null){var regtmls=Registers.getRegister("module_templates");if(BaseObject.is(regtmls,"TemplateRegister")){var regname=(tn.module||"default")+"/"+tn.name;tml=regtmls.item(regname);if(tml!=null){return tml;}}if(!BaseObject.getProperty(options,"nodom",false)){tml=ITemplateSourceImpl.GetTemplateFromDom(tn.module,tn.name,options);if(tml!=null)return tml;tml=null;}}return null;};ITemplateSourceImpl.GetTemplateFromDom=function(module,name,options){var sel="";if(typeof module=="string"){sel+=module;}if(typeof name!="string"){jbTrace.log("The template name has to be a string.");}else{sel+=sel.length>0?"_"+name:name;}var tml=DOMUtil.queryOne("#"+sel);if(tml==null)tml=DOMUtil.queryOne("."+sel);if(tml!=null){return tml.innerHTML;}return null;};ITemplateSourceImpl.ParseTemplateName=function(tname){var r={};if(typeof tname=="string"){var arr=tname.split("/");if(arr!=null&&arr.length>0){if(arr.length>1){r.module=arr[0];r.name=arr[1];}else{r.module=null;r.name=arr[0];}}}return r;};ITemplateSourceImpl.InstantiateTemplate=function(comp){if(BaseObject.is(comp,"Base")&&BaseObject.is(comp,"ITemplateSource")){var el=new DOMUtilElement(comp.root);var tml=comp.get_template();if(tml!=null){el.Empty();el.append(tml);}}};