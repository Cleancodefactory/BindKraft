function SugaryDispatcher(op){this.$operation=op;BaseObject.apply(this,arguments);this.dispatcher.set_adviseNewComers(true);}SugaryDispatcher.Inherit(BaseObject,"SugaryDispatcher");SugaryDispatcher.Implement(IInvocationWithArrayArgs);SugaryDispatcher.Implement(IInvoke);SugaryDispatcher.prototype.$operation=null;SugaryDispatcher.$tellsuccess=function(op,handler){if(op.isOperationSuccessful()){if(BaseObject.isCallback(handler)){BaseObject.callCallback(handler,op.getOperationResult(),op);}}};SugaryDispatcher.$tellfailure=function(op,handler){if(!op.isOperationSuccessful()){if(BaseObject.isCallback(handler)){BaseObject.callCallback(handler,op.getOperationErrorInfo(),op);}}};SugaryDispatcher.prototype.dispatcher=new InitializeEvent("The dispatcher to advise handlers");SugaryDispatcher.prototype.invokeWithArgsArray=function(args){this.dispatcher.invokeWithArgsArray(args);};SugaryDispatcher.prototype.invoke=function(args){this.dispatcher.invokeWithArgsArray(Array.createCopyOf(arguments));};SugaryDispatcher.prototype.tell=function(handler,priority){this.dispatcher.add(handler,priority);return this;};SugaryDispatcher.prototype.then=function(handler,priority){this.dispatcher.add(handler,priority);return this;};SugaryDispatcher.prototype.onsuccess=function(handler,priority){this.dispatcher.add(new Delegate(null,SugaryDispatcher.$tellsuccess,[handler]),priority);return this;};SugaryDispatcher.prototype.success=SugaryDispatcher.prototype.onsuccess;SugaryDispatcher.prototype.onfailure=function(handler,priority){this.dispatcher.add(new Delegate(null,SugaryDispatcher.$tellfailure,[handler]),priority);return this;};SugaryDispatcher.prototype.failure=SugaryDispatcher.prototype.onfailure;SugaryDispatcher.prototype.complete=function(anotherOp,result){if(BaseObject.is(anotherOp,"SugaryDispatcher"))anotherOp=anotherOp.$operation;this.dispatcher.add(new Delegate(this,this.$complete,[anotherOp,result]));return this;}.Description("Completes another operation with the specified result if current operation is successful and with its error info if unsuccessful.");SugaryDispatcher.prototype.$complete=function(op,anotherOp,result){if(BaseObject.is(anotherOp,"Operation")){if(!anotherOp.isOperationComplete()){anotherOp.CompleteOperation(op.isOperationSuccessful(),op.isOperationSuccessful()?result:op.getOperationErrorInfo());}}};SugaryDispatcher.prototype.transfer=function(anotherOp){if(BaseObject.is(anotherOp,"SugaryDispatcher"))anotherOp=anotherOp.$operation;this.dispatcher.add(new Delegate(this,this.$transfer,[anotherOp]));return this;}.Description("Completes another operation with the specified result if current operation is successful and with its error info if unsuccessful.");SugaryDispatcher.prototype.$transfer=function(op,anotherOp){if(BaseObject.is(anotherOp,"Operation")){if(!anotherOp.isOperationComplete()){anotherOp.CompleteOperation(op.isOperationSuccessful(),op.isOperationSuccessful()?op.getOperationResult():op.getOperationErrorInfo());}}};SugaryDispatcher.prototype.succeed=function(anotherOp,result){if(BaseObject.is(anotherOp,"SugaryDispatcher"))anotherOp=anotherOp.$operation;this.dispatcher.add(new Delegate(this,this.$complete,[anotherOp,result]));return this;}.Description("Completes another operation with the specified result if current operation is successful and with its error infoif unsuccessful.");SugaryDispatcher.prototype.$succeed=function(op,anotherOp,result){if(BaseObject.is(anotherOp,"Operation")){if(!anotherOp.isOperationComplete()){anotherOp.CompleteOperation(true,result);}}};SugaryDispatcher.prototype.fail=function(anotherOp,errinfo){if(BaseObject.is(anotherOp,"SugaryDispatcher"))anotherOp=anotherOp.$operation;this.dispatcher.add(new Delegate(this,this.$complete,[anotherOp,errinfo]));return this;}.Description("Completes another operation with the specified result if current operation is successful and with its error infoif unsuccessful.");SugaryDispatcher.prototype.$fail=function(op,anotherOp,errinfo){if(BaseObject.is(anotherOp,"Operation")){if(!anotherOp.isOperationComplete()){anotherOp.CompleteOperation(false,errinfo);}}};SugaryDispatcher.prototype.clear=function(){this.dispatcher.reset();this.dispatcher.removeAll();return this;};