function CallContext(){BaseObject.apply(this,arguments);}CallContext.Inherit(BaseObject,"CallContext");CallContext.prototype.contexts=new InitializeArray("Contexts stack");CallContext.prototype.newContext=function(owner){var ctx=new CallContextEntry(owner,this.currentContext());this.contexts.push(ctx);return ctx;};CallContext.prototype.rootContext=function(owner,scheduler){var ctx=null;if(this.contexts.length>0){if(owner!=null){for(var i=this.contexts.length-1;i>=0;i--){ctx=this.contexts[i];if(ctx!=null&&ctx.owner==owner){this.contexts.length=i+1;return ctx;}}}}ctx=new CallContextEntry(owner,scheduler);this.contexts.push(ctx);return ctx;};CallContext.prototype.currentContext=function(){if(this.contexts.length>0){return this.contexts[this.contexts.length-1];}else{return null;}};CallContext.prototype.obtain_current=function(){if(this.contexts.length>0){return this.contexts[this.contexts.length-1];}else{return this.rootContext();}};CallContext.prototype.resetContext=function(owner){if(owner!=null){for(var i=this.contexts.length-1;i>=0;i--){var ctx=this.contexts[i];if(ctx!=null&&ctx.owner==owner){this.contexts.length=i;break;}}}else{this.contexts.length=0;}};CallContext.prototype.endContext=function(owner){if(this.contexts.length>0){if(owner!=null){for(var i=this.contexts.length-1;i>=0;i--){var ctx=this.contexts[i];if(ctx!=null&&ctx.owner==owner){this.contexts.length=i;break;}}}else{return this.contexts.pop();}}return null;};CallContext.prototype.currentAsyncResult=function(){var ctx=this.currentContext();if(ctx!=null){return ctx.currentAsyncResult();}return null;};CallContext.currentContext=function(){return CallContext.instance.currentContext();};CallContext.obtain_current=function(){return CallContext.instance.obtain_current();};CallContext.rootContext=function(scheduler){return CallContext.instance.rootContext(scheduler);};CallContext.newContext=function(){return CallContext.instance.newContext();};CallContext.endContext=function(){return CallContext.instance.endContext();};CallContext.resetContext=function(owner){return CallContext.instance.resetContext(owner);};CallContext.currentAsyncResult=function(filter){if(filter==null){return CallContext.instance.currentAsyncResult();}else{var ar=CallContext.instance.currentAsyncResult();var key=ar.get_key();if(BaseObject.is(filter,"Array")){return filter.FirstOrDefault(function(idx,fltItem){if(fltItem==key)return ar;return null;});}else if(typeof filter=="string"){var filts=filter.split(",");if(BaseObject.is(filts,"Array")){return filts.FirstOrDefault(function(idx,fltItem){if(fltItem==key)return ar;return null;});}else{return null;}}}return null;};CallContext.instance=new CallContext();